<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Manueel telsysteem 12urenloop</title>
<link href="style.css" media="screen" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="http://www.fkgent.be/assets/js/jquery-1.5.1.min.js"></script>
<script>

var DELAY = 5; // button clicking delay to prevent cheating (seconds)

function count(id) {
	disableButton(id); // disable button to prevent cheating
	
	//TODO: instead of every click, maybe update every x min
	// update
	$.post('ajax.php', {f: "count", cid: id}, function(data) {
		document.getElementById("Score"+id).innerHTML++;	
	});
}

function disableButton(id) {
	document.getElementById(id).disabled = true;
	var enableButtonFunction = function() { document.getElementById(id).disabled = false; };
	var t = setTimeout(enableButtonFunction, DELAY * 1000);  // delay
} 

 $(document).ready(function() {
	$.get('ajax.php', {f: "init"}, function(data) {
		var NUM_TEAMS = data.num_teams;
	
		var ver = Math.round(Math.sqrt(NUM_TEAMS));
		var hor = Math.ceil(Math.sqrt(NUM_TEAMS));
		var width = Math.floor(window.innerWidth/hor * 0.95);
		var height = Math.floor(window.innerHeight/ver * 0.95);

		$.each(data.teams, function(index, value) {
			var team = '<button id="'+ value.id +'" style="width:' + width + 'px; height:' + height + 'px;" class="button" onClick="count('+ value.id +')"><table width="' + width * 0.9 + 'px" height="'+ height * 0.9 +'px"><tr height="70%"><td>'+ value.id +'</td></tr><tr><td class="button_small">'+ value.naam +'</td></tr><tr><td id="Score'+ value.id +'" class="button_small">'+ value.laps +'</td></tr></table></button>';
			$(team).appendTo("#buttons");
		});
	}, "json");
});

</script>
</head>
<body>
<div id="buttons"></div>
</body>

</html>


